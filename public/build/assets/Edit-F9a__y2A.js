import{r as f,j as e,Y as T,y as g}from"./app-nNOKH99h.js";import{A as S}from"./AuthenticatedLayout-DuWjuuyT.js";import{I as p}from"./InputLabel-pmu_96lA.js";import{T as h}from"./TextInput-BeOhOwRp.js";import{T as E,a as j}from"./TextAreaInput-Bi2SGvMN.js";import{P,D as I}from"./Payment-CEftT4BV.js";import{d as b}from"./dayjs.min-CnlO95f7.js";import{P as A}from"./PrimaryButton-BVPKKakc.js";import{I as u}from"./InputError-CvwNwlWB.js";import{Q as F,B as R}from"./react-toastify.esm-BqJ5za_l.js";import"./BackBtn-C3HNZR8l.js";import"./AlertForm-Bh_VkF13.js";import"./module-B0GYdjgo.js";import"./emotion-unitless.esm-sScrWPmR.js";import"./clsx-B-dksMZM.js";import"./customParseFormat-C2VT_rEb.js";function Z({event:s,auth:y,errors:m,session:v}){const[_,Y]=f.useState(b().format("h:mm:ss A")),x="bg-white mx-2 my-3 rounded-xl px-3 py-3 pb-10 space-y-6 shadow-xl",[n,c]=f.useState({name:s.name,description:s.description?s.description:"",date:s.day.date,start_time:s.start_time,end_time:s.end_time,all_day:s.all_day,telephone_1:s.telephone_1?s.telephone_1:"",telephone_2:s.telephone_2?s.telephone_2:"",cost:s.cost?s.cost:"",payments:s.payments?s.payments:[]}),d=(t,r)=>{c(a=>({...a,[t]:r}))},N=(t,r,a)=>{c(l=>{const o=l.payments.map(i=>{if(a){if(i.id==a)return{...i,date:t}}else if(i.component_id==r)return{...i,date:t};return i});return{...l,payments:o}})},k=(t,r,a)=>{c(l=>{const o=l.payments.map(i=>{if(a){if(i.id==a)return{...i,deposit:t}}else if(i.component_id==r)return{...i,deposit:t};return i});return{...l,payments:o}})},D=t=>{t.preventDefault();var r=route("events.update",[s.id]);g.visit(r,{method:"put",data:n,replace:!1,preserveState:!0,preserveScroll:!0,onSuccess:a=>{R(a.props.flash.success_message),c(l=>({...l,payments:a.props.event.payments}))}})},C=()=>{c(t=>{const r=Object.keys(t.payments).length.toString();var a={id:"",date:b().format("YYYY-MM-DD"),event_id:s.id,deposit:0,component_id:r};return{...t,payments:[...t.payments,a]}})},w=(t,r)=>{debugger;c(a=>{if(r){var l=route("events.removePayment");return g.visit(l,{method:"delete",data:{id:r},replace:!1,preserveState:!0,preserveScroll:!0,onSuccess:o=>{}}),{...a,payments:a.payments.filter(o=>parseInt(o.id)!=r)}}else return{...a,payments:a.payments.filter(o=>parseInt(o.component_id)!=t)}})};return e.jsxs(S,{user:y.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Edit Event "}),backBtn:route("events.show",[s.id]),session:v,children:[e.jsx(T,{title:"Add Task or Event"}),e.jsx(F,{}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:x,children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",value:"Name"}),e.jsx(h,{id:"name",value:n.name,onChange:t=>d("name",t.target.value),type:"text",className:"mt-1 block w-full",autoComplete:"Name","data-cy":"name"}),e.jsx(u,{message:m.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"description",value:"Description"}),e.jsx(E,{id:"description",value:n.description,onChange:t=>d("description",t.target.value),className:"mt-1 block w-full","data-cy":"description"}),e.jsx(u,{message:m.description,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"telephone_1",value:"Contact Numbers"}),e.jsx(h,{id:"telephone_1",value:n.telephone_1,onChange:t=>d("telephone_1",t.target.value),type:"tel",className:"mt-1 block w-full",placeholder:"contact number 1","data-cy":"telephone_1"}),e.jsx(h,{id:"telephone_2",value:n.telephone_2,onChange:t=>d("telephone_2",t.target.value),type:"tel",className:"mt-3 block w-full",placeholder:"contact number 2","data-cy":"telephone_2"})]})]}),e.jsxs("div",{className:x,children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"cost",value:"Cost"}),e.jsx(h,{id:"cost",value:n.cost?n.cost:"",onChange:t=>d("cost",t.target.value),type:"number",className:"mt-1 block w-full",autoComplete:"Name","data-cy":"cost"}),e.jsx(u,{message:m.cost,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"text-xl text-gray-600",children:"Deposits"}),e.jsx("button",{type:"button",onClick:()=>C(),"data-cy":"btn-add-deposit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-4 rounded text-xl mb-2 ml-5",id:"editButton",children:e.jsx("i",{className:"fa-regular fa-plus"})})]}),n.payments.map((t,r)=>e.jsx("div",{children:e.jsx(P,{component_id:t==null?void 0:t.component_id,defaultDate:t.date,defaultPayment:t.deposit,payment_id:t.id,onChangeDate:(a,l,o)=>N(a,l,o),onChangeDeposit:(a,l,o)=>k(a,l,o),onDepositRemove:(a,l)=>w(a,l)},r)},r)),e.jsx(u,{message:m.deposit,className:"mt-2"})]})]}),e.jsxs("div",{className:x,children:[e.jsxs("div",{className:"ml-1",children:[e.jsx(p,{value:"Select Date"}),e.jsx(I,{label:"Select Date",onDateChange:t=>d("date",t),defaultDate:n.date})]}),e.jsx(p,{value:`Event Time -  now::(${_})`}),e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!!n.all_day,onChange:t=>d("all_day",t.target.checked),className:"sr-only peer","data-cy":"all-day"}),e.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-xl font-medium text-gray-900 dark:text-gray-300",children:"All Day"})]}),n.all_day?"":e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(j,{label:"Start Time",onTimeChange:t=>d("start_time",t),defaultTime:n.start_time}),e.jsx(u,{message:m.start_time,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(j,{label:"End Time",onTimeChange:t=>d("end_time",t),defaultTime:n.end_time}),e.jsx(u,{message:m.end_time,className:"mt-2"})]})]}),e.jsx("div",{className:"text-center mb-5",children:e.jsx(A,{processing:!1,"data-cy":"submit",disabled:!1,children:"Update Event "})})]})]})]})}export{Z as default};
